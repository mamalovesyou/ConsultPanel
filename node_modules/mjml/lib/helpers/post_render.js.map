{"version":3,"sources":["helpers/post_render.js"],"names":[],"mappings":"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","file":"helpers/post_render.js","sourcesContent":["import _ from 'lodash'\n\nexport const removeCDATA = str => str.replace(/<!--\\[CDATA\\[([^]*?)\\]\\]-->/gm, '$1')\n\nexport const insertColumnMediaQuery = $ => {\n  const mediaQueries = []\n\n  _.each({'mj-column-per': '%', 'mj-column-px': 'px'}, (unit, className) => {\n    const columnWidths = []\n\n    $(`[class*=\"${className}\"]`).each(function () {\n      columnWidths.push($(this).data('column-width'))\n      $(this).removeAttr('data-column-width')\n    })\n\n    _.uniq(columnWidths).forEach((width) => {\n      const mediaQueryClass = `${className}-${width}`\n\n      mediaQueries.push(`.${mediaQueryClass}, * [aria-labelledby=\"${mediaQueryClass}\"] { width:${width}${unit}!important; }`)\n    })\n  })\n\n  if (mediaQueries.length > 0) {\n    const mediaQuery = `<style type=\"text/css\">\n  @media only screen and (min-width:480px) {\n    ${mediaQueries.join('\\n')}\n  }\n</style>\\n`\n\n    $('head').append(mediaQuery)\n  }\n\n  return $\n}\n\nexport const fixOutlookLayout = $ => {\n  const bodyWidth = $('.mj-body').data('width')\n\n  $('.mj-body').removeAttr('data-width')\n\n  $('.mj-section-outlook-background').each(function () {\n    const url = $(this).data('url')\n    const width = $(this).data('width')\n\n    $(this)\n      .removeAttr('class')\n      .removeAttr('data-url')\n      .removeAttr('data-width')\n\n    if (!url) {\n      return\n    }\n\n    $(this).before(`<!--[if gte mso 9]>\n      <v:rect xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"true\" stroke=\"false\" style=\"width:${width}px;\">\n        <v:fill origin=\"0.5, 0\" position=\"0.5,0\" type=\"tile\" src=\"${url}\" />\n        <v:textbox style=\"mso-fit-shape-to-text:true\" inset=\"0,0,0,0\">\n      <![endif]-->`)\n\n    $(this).after(`<!--[if gte mso 9]>\n        </v:textbox>\n      </v:rect>\n      <![endif]-->`)\n  })\n\n  $('.mj-body-outlook-open').each(function () {\n    $(this).replaceWith(`<!--[if mso]>\n      <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"${bodyWidth}\" align=\"center\" style=\"width:${bodyWidth}px;\"><tr><td>\n      <![endif]-->`)\n  })\n\n  $('.mj-body-outlook-line').each(function () {\n    $(this).replaceWith(`<!--[if mso]>\n      </td></tr></table>\n      <![endif]-->\n      <!--[if mso]>\n      <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"${bodyWidth}\" align=\"center\" style=\"width:${bodyWidth}px;\"><tr><td>\n      <![endif]-->`)\n  })\n\n  $('.mj-body-outlook-close').each(function () {\n    $(this).replaceWith(`<!--[if mso]>\n      </td></tr></table>\n      <![endif]-->`)\n  })\n\n  $('.mj-section-outlook-open').each(function () {\n    const $columnDiv = $(this).next()\n\n    $(this).replaceWith(`<!--[if mso]>\n      <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"vertical-align:${$columnDiv.data('vertical-align')};width:${parseInt($(this).data('width'))}px;\">\n      <![endif]-->`)\n\n    $columnDiv.removeAttr('data-vertical-align')\n  })\n\n  $('.mj-section-outlook-line').each(function () {\n    const $columnDiv = $(this).next()\n\n    $(this).replaceWith(`<!--[if mso]>\n    </td><td style=\"vertical-align:${$columnDiv.data('vertical-align')};width:${parseInt($(this).data('width'))}px;\">\n      <![endif]-->`)\n\n    $columnDiv.removeAttr('data-vertical-align')\n  })\n\n  $('.mj-section-outlook-close').each(function () {\n    $(this).replaceWith(`<!--[if mso]>\n      </td></tr></table>\n      <![endif]-->`)\n  })\n\n  $('.mj-social-outlook-open').each(function () {\n    $(this).replaceWith(`<!--[if mso]>\n      <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tr><td>\n      <![endif]-->`)\n  })\n\n  $('.mj-social-outlook-line').each(function () {\n    $(this).replaceWith(`<!--[if mso]>\n      </td><td>\n      <![endif]-->`)\n  })\n\n  $('.mj-social-outlook-close').each(function () {\n    $(this).replaceWith(`<!--[if mso]>\n      </td></tr></table>\n      <![endif]-->`)\n  })\n\n  $('.mj-divider-outlook').each(function () {\n    const insertNode = `<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"${$(this).attr('style')}\" width=\"${$(this).data('divider-width')}\"><tr><td>&nbsp;</td></tr></table>`\n\n    $(this).removeAttr('data-divider-width')\n\n    $(this)\n      .removeAttr('class')\n      .after(`<!--[if mso]>${insertNode}<![endif]-->`)\n  })\n\n  return $\n}\n\nexport const fixLegacyAttrs = $ => {\n  const legacyAttrs = ['align', 'valign', 'bgcolor', 'border', 'background']\n\n  $('body').css({ background: $('.mj-body').data('background-color') })\n  $('.mj-body').removeAttr('data-background-color')\n\n  // https://github.com/facebook/react/issues/140 ...\n  // server side workaround to allow custom tags.\n  legacyAttrs.forEach(attr => {\n    const dataAttr = `data-legacy-${attr}`\n\n    $(`[${dataAttr}]`).each(function () {\n      $(this).attr(attr, $(this).attr(dataAttr))\n      $(this).removeAttr(dataAttr)\n    })\n  })\n\n  return $\n}\n\nexport const clean = $ => {\n  $('body').each(function () {\n    if ($(this).attr('style') === '') {\n      $(this).removeAttr('style')\n    }\n  })\n\n  $('.mj-body')\n    .removeAttr('class')\n    .removeAttr('style')\n\n  $('.mj-raw').each(function () {\n    $(this).replaceWith($(this).html())\n  })\n\n  return $\n}\n"],"sourceRoot":"/source/"}